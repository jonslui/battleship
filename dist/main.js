(()=>{"use strict";const e=e=>({createShip:(a,t)=>{e.ships.push(((e,a)=>{let t={name:a,length:e.length,coords:e,hits:[],sunk:!1};return Object.assign({state:t},(e=>({hit:a=>{e.hits.push(a)}}))(t),(e=>({isSunk:()=>{e.hits.length>=e.length&&(e.sunk=!0)}}))(t))})(a,t))}}),a=()=>{let a={missed_attacks:[],ships:[]};return Object.assign({state:a},e(a),(e=>({receiveAttack:a=>{for(let t=0;t<e.ships.length;t+=1)if(e.ships[t].state.coords.includes(a))return e.ships[t].hit(a),e.ships[t].isSunk(),e.ships[t].state.sunk?e.ships.splice(t,1):"";e.missed_attacks.push(a)}}))(a),(e=>({shipsRemaining:()=>e.ships.length>0}))(a))},t=(e,a)=>{let t={is_human:e,available_moves:[]};return Object.assign({state:t},(e=>({launchAttack:a=>!!e.available_moves.includes(a)&&e.available_moves.splice(e.available_moves.indexOf(a),1)[0]}))(t),(e=>({randomCoord:()=>e.available_moves[~~(Math.random()*e.available_moves.length)]}))(t),(e=>({populateAvailableMoves:a=>{for(let t=0+a;t<100+a;t+=1)e.available_moves.push(t)}}))(t))},l=()=>{let e={board:null,tiles:{}};return Object.assign({state:e},(e=>({createBoard:a=>{const t=document.getElementById("content"),l=document.createElement("div");l.setAttribute("class","gameboard"),l.setAttribute("id",a),t.appendChild(l),e.board=l}}))(e),(e=>({createTiles:(a,t)=>{for(let l=t;l<t+100;l+=1){const t=document.createElement("div");a?t.setAttribute("class","player2_tile"):t.setAttribute("class","player1_tile"),t.setAttribute("id",l),e.tiles[l]=t,e.board.appendChild(t)}}}))(e),{createShips:e=>{e.state.ships.forEach((e=>{e.state.coords.forEach((e=>{const a=document.getElementById(e);a.removeAttribute("class","player1_tile"),a.setAttribute("class","ship")}))}))}},(e=>({changeTileDisplay:(a,t,l)=>{let r=e.tiles[a];t&&null!=l?r.setAttribute("class","hit"):r.setAttribute("class","miss")}}))(e))},r=()=>{let e={player1:null,player2:null,player1Board:null,player2Board:null,player1DOMBoard:null,player2DOMBoard:null};return Object.assign({state:e},(e=>({initializeGame:()=>{e.player1=t(!0),e.player1.populateAvailableMoves(100),e.player1Board=a(),e.player1Board.createShip([0,1,2,3,4],"Carrier"),e.player2=t(!0),e.player2.populateAvailableMoves(0),e.player2Board=a(),e.player2Board.createShip([100,101,102,103,104],"Carrier"),e.player1DOMBoard=l(),e.player1DOMBoard.createBoard("player1_board"),e.player1DOMBoard.createTiles(!1,0),e.player1DOMBoard.createShips(e.player1Board),e.player2DOMBoard=l(),e.player2DOMBoard.createBoard("player2_board"),e.player2DOMBoard.createTiles(!0,100),e.player2DOMBoard.createShips(e.player2Board)}}))(e),(e=>({gameLoop:()=>{for(let a=100;a<200;a++)document.getElementById(a).addEventListener("click",(()=>{const t=e.player1.launchAttack(a);if(0!=t){const a=e.player2Board.receiveAttack(t);if(e.player2DOMBoard.changeTileDisplay(t,!0,a),!1===e.player2Board.shipsRemaining())return void events.emit("gameover");const l=e.player2.randomCoord(),r=e.player1Board.receiveAttack(e.player2.launchAttack(l));e.player1DOMBoard.changeTileDisplay(l,!0,r)}}))}}))(e))},s=()=>{let e={controller:r()};return Object.assign({controller:e.controller,gameOver:function(){document.getElementById("gameover_container").style.display="inline-block"},newGame:function(){const e=document.getElementById("content");if(null!=e.firstChild)for(;e.firstChild;)e.removeChild(e.firstChild);let a=s();a.controller.initializeGame(),a.controller.gameLoop()}})};let i=s();i.newGame(),events.on("gameover",i.gameOver)})();